"use strict";

var _steps = require("cypress-cucumber-preprocessor/steps");

const getRootOrgUnitByLabel = label => {
  const rootOrgUnitLabelSelector = "\n        [data-test=\"dhis2-uiwidgets-orgunittree\"]\n        > [data-test=\"dhis2-uiwidgets-orgunittree-node\"]\n        > [data-test=\"dhis2-uiwidgets-orgunittree-node-content\"]\n        > [data-test=\"dhis2-uiwidgets-orgunittree-node-label\"]\n        label\n    ";
  return cy.contains(rootOrgUnitLabelSelector, label).parents('[data-test="dhis2-uiwidgets-orgunittree-node"]');
};

(0, _steps.Given)('a OrganisationUnitTree with children and no paths in the initiallyExpanded prop is rendered', () => {
  cy.visitStory('OrganisationUnitTree/expanded', 'No initially expanded paths');
});
(0, _steps.Given)('a OrganisationUnitTree with children and the path of the first unit on the second level in the initiallyExpanded prop is rendered', () => {
  cy.visitStory('OrganisationUnitTree/expanded', 'Initially expanded paths');
});
(0, _steps.Given)('both a sub org unit with children and a main org unit are root org units', () => {
  cy.visitStory('OrganisationUnitTree/expanded', 'with root main and root sub org unit');
});
(0, _steps.Given)('the root main org unit is expanded', () => {
  getRootOrgUnitByLabel('Org Unit 1').find('> [data-test="dhis2-uiwidgets-orgunittree-node-toggle"]').click();
});
(0, _steps.When)('the user expands the sub org unit within the main org unit tree', () => {
  getRootOrgUnitByLabel('Org Unit 1').contains('[data-test="dhis2-uiwidgets-orgunittree-node"]', 'Org Unit 2').find('> [data-test="dhis2-uiwidgets-orgunittree-node-toggle"]').click().should('have.class', 'open');
});
(0, _steps.When)('the user expands the root sub org unit', () => {
  getRootOrgUnitByLabel('Org Unit 2').find('> [data-test="dhis2-uiwidgets-orgunittree-node-toggle"]').click().should('have.class', 'open');
});
(0, _steps.Then)('the root unit is closed', () => {
  cy.getOrgUnitByLabel('Org Unit 1').shouldBeAClosedNode();
});
(0, _steps.Then)('the root unit is opened', () => {
  cy.getOrgUnitByLabel('Org Unit 1').shouldBeAnOrgUnitNode();
});
(0, _steps.Then)('the root sub org unit should not expand', () => {
  getRootOrgUnitByLabel('Org Unit 2').find('> [data-test="dhis2-uiwidgets-orgunittree-node-toggle"]').should('not.have.class', 'open');
});
(0, _steps.Then)('the sub org unit within the main org unit tree should not expand', () => {
  getRootOrgUnitByLabel('Org Unit 1').contains('[data-test="dhis2-uiwidgets-orgunittree-node"]', 'Org Unit 2').find('> [data-test="dhis2-uiwidgets-orgunittree-node-toggle"]').should('not.have.class', 'open');
});