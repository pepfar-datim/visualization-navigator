{
  "sqlViews": [
    {
      "name": "Visualization Navigator app results",
      "id": "HVy4XTeblkj",
      "sqlQuery": "\nwith viewcount as (\n\tselect favoriteuid as uid, count(*) as count\n\t\tfrom datastatisticsevent\n\t\tgroup by favoriteuid\n\n),\n\nlastviewdate as (\n\tselect favoriteuid as uid, max(timestamp) as date\n\t\tfrom datastatisticsevent\n\t\tgroup by favoriteuid\n),\nconsolidated as (\n\nselect d.uid,d.name,d.count,  to_char(vd.date,'YYYY-MM-DD') as date,\n \t'dashboard' as type\n\tfrom (select ch.*, case when viewc.count is null then 0 else viewc.count end as count from dashboard ch left join viewcount viewc on ch.uid=viewc.uid) d\n\t\n        left join lastviewdate vd on d.uid=vd.uid\n\twhere \n\td.name ilike '%${favName}%'\n\n\tand d.count > ${minCount}\n\tand d.count < ${maxCount}\n\tand (vd.date > '${minDate}' and vd.date < '${maxDate}' or (1=${retrieveNevers} and vd.date is null))\n\nUNION\n\nselect m.uid,m.name,m.count,  to_char(vd.date,'YYYY-MM-DD') as date,\n \t'map' as type\n\tfrom (select ch.*, case when viewc.count is null then 0 else viewc.count end as count from map ch left join viewcount viewc on ch.uid=viewc.uid) m\n\t\n        left join lastviewdate vd on m.uid=vd.uid\n\twhere \n\tm.name ilike '%${favName}%'\n\n\tand m.count > ${minCount}\n\tand m.count < ${maxCount}\n\tand (vd.date > '${minDate}' and vd.date < '${maxDate}' or (1=${retrieveNevers} and vd.date is null))\n\nUNION\n\nselect c.uid,c.name,c.count,  to_char(vd.date,'YYYY-MM-DD') as date,\n \tcase when c.type = 'PIVOT_TABLE' then 'pivot' else 'chart' end as type\n\tfrom (select ch.*, case when viewc.count is null then 0 else viewc.count end as count from visualization ch left join viewcount viewc on ch.uid=viewc.uid) c\n\t\n        left join lastviewdate vd on c.uid=vd.uid\n\twhere \n\tc.name ilike '%${favName}%'\n\n\tand c.count > ${minCount}\n\tand c.count < ${maxCount}\n\tand (vd.date > '${minDate}' and vd.date < '${maxDate}' or (1=${retrieveNevers} and vd.date is null))\n)\nselect * from consolidated where type like '%${visTypes}%' order by name\nlimit ${limitCount};"
    },
    {
      "name": "Visualization Navigator app results (with owner)",
      "id": "f7PbltszOTn",
      "sqlQuery": "with viewcount as (\n\tselect favoriteuid as uid, count(*) as count\n\t\tfrom (select * from datastatisticsevent where timestamp > '${dseLower}' and timestamp < '${dseUpper}') dse\n\t\tgroup by favoriteuid\n\n),\n\nlastviewdate as (\n\tselect favoriteuid as uid, max(timestamp) as date\n\t\tfrom datastatisticsevent\n\t\tgroup by favoriteuid\n),\nconsolidated as (\n\nselect d.uid,d.name,d.count as view_count, to_char(vd.date,'YYYY-MM-DD') as date,\n \t'dashboard' as type, d.username\n\tfrom (select ch.*,u.username, case when viewc.count is null then 0 else viewc.count end as count from dashboard ch left join viewcount viewc on ch.uid=viewc.uid left join uzers u on ch.userid = u.userid) d\n\t\n        left join lastviewdate vd on d.uid=vd.uid\n\twhere \n\td.name ilike '%${favName}%'\n\tand d.username ilike '%${userName}%'\n\tand d.count > ${minCount}\n\tand d.count < ${maxCount}\n\tand (vd.date > '${minDate}' and vd.date < '${maxDate}' or (1=${retrieveNevers} and vd.date is null))\n\nUNION\n\nselect m.uid,m.name,m.count as view_count, to_char(vd.date,'YYYY-MM-DD') as date,\n \t'map' as type, m.username\n\tfrom (select ch.*,u.username, case when viewc.count is null then 0 else viewc.count end as count from map ch left join viewcount viewc on ch.uid=viewc.uid left join uzers u on ch.userid = u.userid) m\n\t\n        left join lastviewdate vd on m.uid=vd.uid\n\twhere \n\tm.name ilike '%${favName}%'\n\tand m.username ilike '%${userName}%'\n\tand m.count > ${minCount}\n\tand m.count < ${maxCount}\n\tand (vd.date > '${minDate}' and vd.date < '${maxDate}' or (1=${retrieveNevers} and vd.date is null))\n\nUNION\n\nselect c.uid,c.name,c.count as view_count, to_char(vd.date,'YYYY-MM-DD') as date,\n \tcase when c.type = 'PIVOT_TABLE' then 'pivot' else 'chart' end as type, c.username\n\tfrom (select ch.*,u.username, case when viewc.count is null then 0 else viewc.count end as count from visualization ch left join viewcount viewc on ch.uid=viewc.uid left join uzers u on ch.userid = u.userid) c\n\t\n        left join lastviewdate vd on c.uid=vd.uid\n\twhere \n\tc.name ilike '%${favName}%'\n\tand c.username ilike '%${userName}%'\n\tand c.count > ${minCount}\n\tand c.count < ${maxCount}\n\tand (vd.date > '${minDate}' and vd.date < '${maxDate}' or (1=${retrieveNevers} and vd.date is null))\n)\n\nselect * from consolidated where type like '%${visTypes}%' order by name\nlimit ${limitCount};\n"
    },
    {
      "name": "Visualization Navigator app view counts",
      "id": "nwgL1LWGy58",
      "sqlQuery": "with viewcount as (\n\tselect favoriteuid as uid, count(*) as count\n\t\tfrom datastatisticsevent\n\t\twhere favoriteuid='${uid}'\n\t\tgroup by favoriteuid\n\n),\n\nlastviewdate as (\n\tselect favoriteuid as uid, max(timestamp) as view_date\n\t\tfrom datastatisticsevent\n\t\twhere favoriteuid='${uid}'\n\t\tgroup by favoriteuid\n)\n\nselect c.uid, vc.count, lv.view_date\nfrom (select uid from visualization where uid='${uid}' union select uid from map where uid='${uid}' union select uid from dashboard where uid='${uid}') c\nleft join viewcount vc on c.uid=vc.uid\nleft join lastviewdate lv on c.uid=lv.uid\n;\n"
    }
  ]
}
