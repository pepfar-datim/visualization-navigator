{"ast":null,"code":"import { InvalidQueryError } from '../types/InvalidQueryError';\nvar validQueryKeys = ['resource', 'id', 'params', 'data'];\nvar validTypes = ['read', 'create', 'update', 'replace', 'delete', 'json-patch'];\nexport var getResourceQueryErrors = function getResourceQueryErrors(type, query) {\n  if (!validTypes.includes(type)) {\n    return [\"Unknown query or mutation type \".concat(type)];\n  }\n\n  if (typeof query !== 'object') {\n    return ['A query or mutation must be a javascript object'];\n  }\n\n  var errors = [];\n\n  if (!query.resource || typeof query.resource !== 'string') {\n    errors.push('Property resource must be a string');\n  }\n\n  if (type === 'create' && query.id) {\n    errors.push(\"Mutation type 'create' does not support property 'id'\");\n  }\n\n  if (query.id && typeof query.id !== 'string') {\n    errors.push('Property id must be a string');\n  }\n\n  if (query.params && typeof query.params !== 'object') {\n    errors.push('Property params must be an object');\n  }\n\n  if (type === 'delete' && query.data) {\n    errors.push(\"Mutation type 'delete' does not support property 'data'\");\n  }\n\n  if (type === 'json-patch' && !Array.isArray(query.data)) {\n    errors.push(\"Mutation type 'json-patch' requires property 'data' to be of type Array\");\n  }\n\n  var invalidKeys = Object.keys(query).filter(function (k) {\n    return !validQueryKeys.includes(k);\n  });\n  invalidKeys.forEach(function (k) {\n    errors.push(\"Property \".concat(k, \" is not supported\"));\n  });\n  return errors;\n};\nexport var validateResourceQueries = function validateResourceQueries(queries) {\n  var names = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n  if (names.length !== queries.length) {\n    for (var i = names.length; i < queries.length; ++i) {\n      names.push('query#' + i);\n    }\n  }\n\n  var errors = queries.reduce(function (errors, query, i) {\n    return errors.concat(getResourceQueryErrors('read', query).map(function (e) {\n      return \"[\".concat(names[i], \"] \").concat(e);\n    }));\n  }, []);\n\n  if (errors.length) {\n    throw new InvalidQueryError(errors);\n  }\n};\nexport var validateResourceQuery = function validateResourceQuery(type, query) {\n  var errors = getResourceQueryErrors(type, query);\n\n  if (errors.length) {\n    throw new InvalidQueryError(errors);\n  }\n};","map":{"version":3,"names":["InvalidQueryError","validQueryKeys","validTypes","getResourceQueryErrors","type","query","includes","concat","errors","resource","push","id","params","data","Array","isArray","invalidKeys","Object","keys","filter","k","forEach","validateResourceQueries","queries","names","length","i","reduce","map","e","validateResourceQuery"],"sources":["/home/jake/SRC/landing-page/node_modules/@dhis2/app-runtime/node_modules/@dhis2/app-service-data/build/es/engine/helpers/validate.js"],"sourcesContent":["import { InvalidQueryError } from '../types/InvalidQueryError';\nconst validQueryKeys = ['resource', 'id', 'params', 'data'];\nconst validTypes = ['read', 'create', 'update', 'replace', 'delete', 'json-patch'];\nexport const getResourceQueryErrors = (type, query) => {\n  if (!validTypes.includes(type)) {\n    return [\"Unknown query or mutation type \".concat(type)];\n  }\n\n  if (typeof query !== 'object') {\n    return ['A query or mutation must be a javascript object'];\n  }\n\n  const errors = [];\n\n  if (!query.resource || typeof query.resource !== 'string') {\n    errors.push('Property resource must be a string');\n  }\n\n  if (type === 'create' && query.id) {\n    errors.push(\"Mutation type 'create' does not support property 'id'\");\n  }\n\n  if (query.id && typeof query.id !== 'string') {\n    errors.push('Property id must be a string');\n  }\n\n  if (query.params && typeof query.params !== 'object') {\n    errors.push('Property params must be an object');\n  }\n\n  if (type === 'delete' && query.data) {\n    errors.push(\"Mutation type 'delete' does not support property 'data'\");\n  }\n\n  if (type === 'json-patch' && !Array.isArray(query.data)) {\n    errors.push(\"Mutation type 'json-patch' requires property 'data' to be of type Array\");\n  }\n\n  const invalidKeys = Object.keys(query).filter(k => !validQueryKeys.includes(k));\n  invalidKeys.forEach(k => {\n    errors.push(\"Property \".concat(k, \" is not supported\"));\n  });\n  return errors;\n};\nexport const validateResourceQueries = (queries, names = []) => {\n  if (names.length !== queries.length) {\n    for (let i = names.length; i < queries.length; ++i) {\n      names.push('query#' + i);\n    }\n  }\n\n  const errors = queries.reduce((errors, query, i) => errors.concat(getResourceQueryErrors('read', query).map(e => \"[\".concat(names[i], \"] \").concat(e))), []);\n\n  if (errors.length) {\n    throw new InvalidQueryError(errors);\n  }\n};\nexport const validateResourceQuery = (type, query) => {\n  const errors = getResourceQueryErrors(type, query);\n\n  if (errors.length) {\n    throw new InvalidQueryError(errors);\n  }\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}