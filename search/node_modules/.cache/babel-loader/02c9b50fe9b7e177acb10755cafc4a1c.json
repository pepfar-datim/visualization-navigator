{"ast":null,"code":"import{urlToFilename}from\"./urlToFilename.service\";import{isTestEnv}from\"../config.service\";var cachedResponseList=[];var fs;var cacheDir;if(typeof process!=='undefined'&&process.env.NODE_ENV==='test'){import('fs').then(function(i){return fs=i;});cacheDir=process.cwd()+'/cachedApiCalls';}function initTestCache(){if(!isTestEnv()||cachedResponseList.length>0)return;if(!fs)throw new Error(\"fs not imported\");if(!fs.existsSync(cacheDir))fs.mkdirSync(cacheDir);cachedResponseList=fs.readdirSync(\"\".concat(cacheDir,\"/\")).map(function(fileName){return fileName.replace('.json','');});}function saveToFile(fileName,data){fs.writeFileSync(\"\".concat(cacheDir,\"/\").concat(fileName,\".json\"),JSON.stringify(data));}function saveResponseToCache(username,url,response){var fileName=urlToFilename(username,url);cachedResponseList.push(fileName);saveToFile(fileName,response);}function isResponseCached(username,url){return cachedResponseList.includes(urlToFilename(username,url));}function getCachedResponse(username,url){var fileName=urlToFilename(username,url);var path=\"\".concat(cacheDir,\"/\").concat(fileName,\".json\");var data=JSON.parse(fs.readFileSync(path).toString());return{json:function json(){return data;}};}export{initTestCache,saveResponseToCache,isResponseCached,getCachedResponse};","map":{"version":3,"names":["urlToFilename","isTestEnv","cachedResponseList","fs","cacheDir","process","env","NODE_ENV","then","i","cwd","initTestCache","length","Error","existsSync","mkdirSync","readdirSync","map","fileName","replace","saveToFile","data","writeFileSync","JSON","stringify","saveResponseToCache","username","url","response","push","isResponseCached","includes","getCachedResponse","path","parse","readFileSync","toString","json"],"sources":["/home/jake/SRC/visualization-navigator-ts/node_modules/@pepfar-react-lib/datim-api/services/cache/getCache.service.ts"],"sourcesContent":["import {urlToFilename} from \"./urlToFilename.service\";\nimport {isTestEnv} from \"../config.service\";\n\nlet cachedResponseList:string[] = [];\nlet fs;\nlet cacheDir;\n\nif (typeof process!=='undefined'&&process.env.NODE_ENV==='test') {\n    import('fs').then(i=>fs=i);\n    cacheDir = process.cwd() + '/cachedApiCalls'\n}\n\nfunction initTestCache(){\n    if (!isTestEnv()||cachedResponseList.length>0) return;\n    if (!fs) throw new Error(`fs not imported`);\n    if (!fs.existsSync(cacheDir)) fs.mkdirSync(cacheDir);\n    cachedResponseList = fs.readdirSync(`${cacheDir}/`).map(fileName => fileName.replace('.json', ''));\n}\n\n\nfunction saveToFile(fileName:string, data:object){\n    fs.writeFileSync(`${cacheDir}/${fileName}.json`, JSON.stringify(data));\n}\n\nfunction saveResponseToCache(username:string, url:string, response:object):void{\n    let fileName = urlToFilename(username, url);\n    cachedResponseList.push(fileName);\n    saveToFile(fileName, response);\n}\n\nfunction isResponseCached(username: string, url:string):boolean{\n    return cachedResponseList.includes(urlToFilename(username, url))\n}\n\nfunction getCachedResponse(username:string, url:string):object{\n    let fileName = urlToFilename(username, url);\n    let path = `${cacheDir}/${fileName}.json`;\n    let data = JSON.parse(fs.readFileSync(path).toString());\n    return {json:()=>data};\n}\n\nexport {\n    initTestCache,\n    saveResponseToCache,\n    isResponseCached,\n    getCachedResponse\n}"],"mappings":"AAAA,OAAQA,aAAR,KAA4B,yBAA5B,CACA,OAAQC,SAAR,KAAwB,mBAAxB,CAEA,GAAIC,CAAAA,kBAA2B,CAAG,EAAlC,CACA,GAAIC,CAAAA,EAAJ,CACA,GAAIC,CAAAA,QAAJ,CAEA,GAAI,MAAOC,CAAAA,OAAP,GAAiB,WAAjB,EAA8BA,OAAO,CAACC,GAAR,CAAYC,QAAZ,GAAuB,MAAzD,CAAiE,CAC7D,OAAO,IAAP,EAAaC,IAAb,CAAkB,SAAAC,CAAC,QAAEN,CAAAA,EAAE,CAACM,CAAL,EAAnB,EACAL,QAAQ,CAAGC,OAAO,CAACK,GAAR,GAAgB,iBAA3B,CACH,CAED,QAASC,CAAAA,aAAT,EAAwB,CACpB,GAAI,CAACV,SAAS,EAAV,EAAcC,kBAAkB,CAACU,MAAnB,CAA0B,CAA5C,CAA+C,OAC/C,GAAI,CAACT,EAAL,CAAS,KAAM,IAAIU,CAAAA,KAAJ,mBAAN,CACT,GAAI,CAACV,EAAE,CAACW,UAAH,CAAcV,QAAd,CAAL,CAA8BD,EAAE,CAACY,SAAH,CAAaX,QAAb,EAC9BF,kBAAkB,CAAGC,EAAE,CAACa,WAAH,WAAkBZ,QAAlB,OAA+Ba,GAA/B,CAAmC,SAAAC,QAAQ,QAAIA,CAAAA,QAAQ,CAACC,OAAT,CAAiB,OAAjB,CAA0B,EAA1B,CAAJ,EAA3C,CAArB,CACH,CAGD,QAASC,CAAAA,UAAT,CAAoBF,QAApB,CAAqCG,IAArC,CAAiD,CAC7ClB,EAAE,CAACmB,aAAH,WAAoBlB,QAApB,aAAgCc,QAAhC,UAAiDK,IAAI,CAACC,SAAL,CAAeH,IAAf,CAAjD,EACH,CAED,QAASI,CAAAA,mBAAT,CAA6BC,QAA7B,CAA8CC,GAA9C,CAA0DC,QAA1D,CAA+E,CAC3E,GAAIV,CAAAA,QAAQ,CAAGlB,aAAa,CAAC0B,QAAD,CAAWC,GAAX,CAA5B,CACAzB,kBAAkB,CAAC2B,IAAnB,CAAwBX,QAAxB,EACAE,UAAU,CAACF,QAAD,CAAWU,QAAX,CAAV,CACH,CAED,QAASE,CAAAA,gBAAT,CAA0BJ,QAA1B,CAA4CC,GAA5C,CAA+D,CAC3D,MAAOzB,CAAAA,kBAAkB,CAAC6B,QAAnB,CAA4B/B,aAAa,CAAC0B,QAAD,CAAWC,GAAX,CAAzC,CAAP,CACH,CAED,QAASK,CAAAA,iBAAT,CAA2BN,QAA3B,CAA4CC,GAA5C,CAA8D,CAC1D,GAAIT,CAAAA,QAAQ,CAAGlB,aAAa,CAAC0B,QAAD,CAAWC,GAAX,CAA5B,CACA,GAAIM,CAAAA,IAAI,WAAM7B,QAAN,aAAkBc,QAAlB,SAAR,CACA,GAAIG,CAAAA,IAAI,CAAGE,IAAI,CAACW,KAAL,CAAW/B,EAAE,CAACgC,YAAH,CAAgBF,IAAhB,EAAsBG,QAAtB,EAAX,CAAX,CACA,MAAO,CAACC,IAAI,CAAC,sBAAIhB,CAAAA,IAAJ,EAAN,CAAP,CACH,CAED,OACIV,aADJ,CAEIc,mBAFJ,CAGIK,gBAHJ,CAIIE,iBAJJ"},"metadata":{},"sourceType":"module"}