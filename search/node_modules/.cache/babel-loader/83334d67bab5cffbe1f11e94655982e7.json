{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nimport { useDataQuery, useConfig } from '@dhis2/app-runtime';\nimport { colors } from '@dhis2/ui-constants';\nimport PropTypes from 'prop-types';\nimport React, { useMemo } from 'react';\nimport Apps from './apps.js';\nimport { joinPath } from './join-path.js';\nimport i18n from './locales/index.js';\nimport { Logo } from './logo.js';\nimport { Notifications } from './notifications.js';\nimport { OnlineStatus } from './online-status.js';\nimport Profile from './profile.js';\nimport { Title } from './title.js';\nconst query = {\n  title: {\n    resource: 'systemSettings/applicationTitle'\n  },\n  help: {\n    resource: 'systemSettings/helpPageLink'\n  },\n  user: {\n    resource: 'me',\n    params: {\n      fields: ['authorities', 'avatar', 'email', 'name', 'settings']\n    }\n  },\n  apps: {\n    resource: 'action::menu/getModules'\n  },\n  notifications: {\n    resource: 'me/dashboard'\n  }\n};\nexport const HeaderBar = _ref => {\n  var _data$user$avatar;\n\n  let {\n    appName,\n    className\n  } = _ref;\n  const {\n    baseUrl,\n    pwaEnabled,\n    headerbar: {\n      showOnlineStatus\n    } = {}\n  } = useConfig();\n  const {\n    loading,\n    error,\n    data\n  } = useDataQuery(query);\n  const apps = useMemo(() => {\n    const getPath = path => path.startsWith('http:') || path.startsWith('https:') ? path : joinPath(baseUrl, 'api', path);\n\n    return data === null || data === void 0 ? void 0 : data.apps.modules.map(app => ({ ...app,\n      icon: getPath(app.icon),\n      defaultAction: getPath(app.defaultAction)\n    }));\n  }, [data]); // See https://jira.dhis2.org/browse/LIBS-180\n\n  if (!loading && !error) {\n    // TODO: This will run every render which is probably wrong!  Also, setting the global locale shouldn't be done in the headerbar\n    const locale = data.user.settings.keyUiLocale || 'en';\n    i18n.setDefaultNamespace('default');\n    i18n.changeLanguage(locale);\n  }\n\n  return /*#__PURE__*/React.createElement(\"header\", {\n    className: _JSXStyle.dynamic([[\"3517276904\", [colors.white]]]) + \" \" + (className || \"\")\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"3517276904\", [colors.white]]]) + \" \" + \"main\"\n  }, !loading && !error && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Logo, null), /*#__PURE__*/React.createElement(Title, {\n    app: appName,\n    instance: data.title.applicationTitle\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"3517276904\", [colors.white]]]) + \" \" + \"right-control-spacer\"\n  }), (pwaEnabled || showOnlineStatus) && /*#__PURE__*/React.createElement(OnlineStatus, null), /*#__PURE__*/React.createElement(Notifications, {\n    interpretations: data.notifications.unreadInterpretations,\n    messages: data.notifications.unreadMessageConversations,\n    userAuthorities: data.user.authorities\n  }), /*#__PURE__*/React.createElement(Apps, {\n    apps: apps\n  }), /*#__PURE__*/React.createElement(Profile, {\n    name: data.user.name,\n    email: data.user.email,\n    avatarId: (_data$user$avatar = data.user.avatar) === null || _data$user$avatar === void 0 ? void 0 : _data$user$avatar.id,\n    helpUrl: data.help.helpPageLink\n  }))), (pwaEnabled || showOnlineStatus) && !loading && !error && /*#__PURE__*/React.createElement(OnlineStatus, {\n    dense: true\n  }), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"3517276904\",\n    dynamic: [colors.white]\n  }, [\".main.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;background-color:#2c6693;border-bottom:1px solid rgba(32,32,32,0.15);color:\".concat(colors.white, \";height:48px;}\"), \".right-control-spacer.__jsx-style-dynamic-selector{margin-left:auto;}\"]));\n};\nHeaderBar.propTypes = {\n  appName: PropTypes.string,\n  className: PropTypes.string\n};","map":{"version":3,"names":["_JSXStyle","useDataQuery","useConfig","colors","PropTypes","React","useMemo","Apps","joinPath","i18n","Logo","Notifications","OnlineStatus","Profile","Title","query","title","resource","help","user","params","fields","apps","notifications","HeaderBar","_ref","_data$user$avatar","appName","className","baseUrl","pwaEnabled","headerbar","showOnlineStatus","loading","error","data","getPath","path","startsWith","modules","map","app","icon","defaultAction","locale","settings","keyUiLocale","setDefaultNamespace","changeLanguage","createElement","dynamic","white","Fragment","instance","applicationTitle","interpretations","unreadInterpretations","messages","unreadMessageConversations","userAuthorities","authorities","name","email","avatarId","avatar","id","helpUrl","helpPageLink","dense","concat","propTypes","string"],"sources":["/home/jake/SRC/landing-page/node_modules/@dhis2-ui/header-bar/build/es/header-bar.js"],"sourcesContent":["import _JSXStyle from \"styled-jsx/style\";\nimport { useDataQuery, useConfig } from '@dhis2/app-runtime';\nimport { colors } from '@dhis2/ui-constants';\nimport PropTypes from 'prop-types';\nimport React, { useMemo } from 'react';\nimport Apps from './apps.js';\nimport { joinPath } from './join-path.js';\nimport i18n from './locales/index.js';\nimport { Logo } from './logo.js';\nimport { Notifications } from './notifications.js';\nimport { OnlineStatus } from './online-status.js';\nimport Profile from './profile.js';\nimport { Title } from './title.js';\nconst query = {\n  title: {\n    resource: 'systemSettings/applicationTitle'\n  },\n  help: {\n    resource: 'systemSettings/helpPageLink'\n  },\n  user: {\n    resource: 'me',\n    params: {\n      fields: ['authorities', 'avatar', 'email', 'name', 'settings']\n    }\n  },\n  apps: {\n    resource: 'action::menu/getModules'\n  },\n  notifications: {\n    resource: 'me/dashboard'\n  }\n};\nexport const HeaderBar = _ref => {\n  var _data$user$avatar;\n\n  let {\n    appName,\n    className\n  } = _ref;\n  const {\n    baseUrl,\n    pwaEnabled,\n    headerbar: {\n      showOnlineStatus\n    } = {}\n  } = useConfig();\n  const {\n    loading,\n    error,\n    data\n  } = useDataQuery(query);\n  const apps = useMemo(() => {\n    const getPath = path => path.startsWith('http:') || path.startsWith('https:') ? path : joinPath(baseUrl, 'api', path);\n\n    return data === null || data === void 0 ? void 0 : data.apps.modules.map(app => ({ ...app,\n      icon: getPath(app.icon),\n      defaultAction: getPath(app.defaultAction)\n    }));\n  }, [data]); // See https://jira.dhis2.org/browse/LIBS-180\n\n  if (!loading && !error) {\n    // TODO: This will run every render which is probably wrong!  Also, setting the global locale shouldn't be done in the headerbar\n    const locale = data.user.settings.keyUiLocale || 'en';\n    i18n.setDefaultNamespace('default');\n    i18n.changeLanguage(locale);\n  }\n\n  return /*#__PURE__*/React.createElement(\"header\", {\n    className: _JSXStyle.dynamic([[\"3517276904\", [colors.white]]]) + \" \" + (className || \"\")\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"3517276904\", [colors.white]]]) + \" \" + \"main\"\n  }, !loading && !error && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Logo, null), /*#__PURE__*/React.createElement(Title, {\n    app: appName,\n    instance: data.title.applicationTitle\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"3517276904\", [colors.white]]]) + \" \" + \"right-control-spacer\"\n  }), (pwaEnabled || showOnlineStatus) && /*#__PURE__*/React.createElement(OnlineStatus, null), /*#__PURE__*/React.createElement(Notifications, {\n    interpretations: data.notifications.unreadInterpretations,\n    messages: data.notifications.unreadMessageConversations,\n    userAuthorities: data.user.authorities\n  }), /*#__PURE__*/React.createElement(Apps, {\n    apps: apps\n  }), /*#__PURE__*/React.createElement(Profile, {\n    name: data.user.name,\n    email: data.user.email,\n    avatarId: (_data$user$avatar = data.user.avatar) === null || _data$user$avatar === void 0 ? void 0 : _data$user$avatar.id,\n    helpUrl: data.help.helpPageLink\n  }))), (pwaEnabled || showOnlineStatus) && !loading && !error && /*#__PURE__*/React.createElement(OnlineStatus, {\n    dense: true\n  }), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"3517276904\",\n    dynamic: [colors.white]\n  }, [\".main.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;background-color:#2c6693;border-bottom:1px solid rgba(32,32,32,0.15);color:\".concat(colors.white, \";height:48px;}\"), \".right-control-spacer.__jsx-style-dynamic-selector{margin-left:auto;}\"]));\n};\nHeaderBar.propTypes = {\n  appName: PropTypes.string,\n  className: PropTypes.string\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}